<!DOCTYPE html>
<html lang="en">
  <head>
    <title>
  创建型-单例模式 · Zhengbledor
</title>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="color-scheme" content="light dark">




<meta name="author" content="Zhengbledor">
<meta name="description" content="创建型-单例模式 Link to heading 7种单例模式的创建 Link to heading 单例模式的实现方式比较多，主要在实现上是否支持懒汉模式、是否线程安全中运用各种技巧。 当然也有一些场景不需要考虑懒加载的情况，会直接使用static静态累或属性和方法的方式进行处理，供外部调用。
0. 静态类使用 Link to heading public class Singleton_00{ public static Map&lt;String, String&gt; cache = new ConcurrentHashMap&lt;String, String&gt;(); } 这样的静态类的方式可以在第一次运行的时候直接初始化Map类，不需要到延迟加载在使用。 1. 懒汉模式（线程不安全） Link to heading public class Singleton_01 { private static Singleton_01 instance; private Singleton_01() { } public static Singleton_01 getInstance(){ if (null != instance) return instance; instance = new Singleton_01(); return instance; } } 有一个特点就是外部不允许直接创建，只能通过Singleton_01.getInstance()来初始化创建该单例。 这种方式的范例确实满足了懒加载，但是如果多个访问者同时进入getInstance()中可能会出现同时存在多个实例的问题。 2. 懒汉模式（线程安全） Link to heading public class Singleton_02 { private static Singleton_02 instance; private Singleton_02() { } public static synchronized Singleton_02 getInstance(){ if (null !">
<meta name="keywords" content="blog">

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="创建型-单例模式"/>
<meta name="twitter:description" content="创建型-单例模式 Link to heading 7种单例模式的创建 Link to heading 单例模式的实现方式比较多，主要在实现上是否支持懒汉模式、是否线程安全中运用各种技巧。 当然也有一些场景不需要考虑懒加载的情况，会直接使用static静态累或属性和方法的方式进行处理，供外部调用。
0. 静态类使用 Link to heading public class Singleton_00{ public static Map&lt;String, String&gt; cache = new ConcurrentHashMap&lt;String, String&gt;(); } 这样的静态类的方式可以在第一次运行的时候直接初始化Map类，不需要到延迟加载在使用。 1. 懒汉模式（线程不安全） Link to heading public class Singleton_01 { private static Singleton_01 instance; private Singleton_01() { } public static Singleton_01 getInstance(){ if (null != instance) return instance; instance = new Singleton_01(); return instance; } } 有一个特点就是外部不允许直接创建，只能通过Singleton_01.getInstance()来初始化创建该单例。 这种方式的范例确实满足了懒加载，但是如果多个访问者同时进入getInstance()中可能会出现同时存在多个实例的问题。 2. 懒汉模式（线程安全） Link to heading public class Singleton_02 { private static Singleton_02 instance; private Singleton_02() { } public static synchronized Singleton_02 getInstance(){ if (null !"/>

<meta property="og:title" content="创建型-单例模式" />
<meta property="og:description" content="创建型-单例模式 Link to heading 7种单例模式的创建 Link to heading 单例模式的实现方式比较多，主要在实现上是否支持懒汉模式、是否线程安全中运用各种技巧。 当然也有一些场景不需要考虑懒加载的情况，会直接使用static静态累或属性和方法的方式进行处理，供外部调用。
0. 静态类使用 Link to heading public class Singleton_00{ public static Map&lt;String, String&gt; cache = new ConcurrentHashMap&lt;String, String&gt;(); } 这样的静态类的方式可以在第一次运行的时候直接初始化Map类，不需要到延迟加载在使用。 1. 懒汉模式（线程不安全） Link to heading public class Singleton_01 { private static Singleton_01 instance; private Singleton_01() { } public static Singleton_01 getInstance(){ if (null != instance) return instance; instance = new Singleton_01(); return instance; } } 有一个特点就是外部不允许直接创建，只能通过Singleton_01.getInstance()来初始化创建该单例。 这种方式的范例确实满足了懒加载，但是如果多个访问者同时进入getInstance()中可能会出现同时存在多个实例的问题。 2. 懒汉模式（线程安全） Link to heading public class Singleton_02 { private static Singleton_02 instance; private Singleton_02() { } public static synchronized Singleton_02 getInstance(){ if (null !" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://zhengbledor.github.io/posts/%E5%88%9B%E5%BB%BA%E5%9E%8B-%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-03-01T00:00:00+00:00" />
<meta property="article:modified_time" content="2023-03-01T00:00:00+00:00" />




<link rel="canonical" href="https://zhengbledor.github.io/posts/%E5%88%9B%E5%BB%BA%E5%9E%8B-%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/">


<link rel="preload" href="/fonts/forkawesome-webfont.woff2?v=1.2.0" as="font" type="font/woff2" crossorigin>


  
  
  <link rel="stylesheet" href="/css/coder.min.01bd429dda63a16d76996eaf0b8da061429b76e714515cb1b246aac7fe7f4b2a.css" integrity="sha256-Ab1CndpjoW12mW6vC42gYUKbducUUVyxskaqx/5/Syo=" crossorigin="anonymous" media="screen" />






  
    
    
    <link rel="stylesheet" href="/css/coder-dark.min.593028e7f7ac55c003b79c230d1cd411bb4ca53b31556c3abb7f027170e646e9.css" integrity="sha256-WTAo5/esVcADt5wjDRzUEbtMpTsxVWw6u38CcXDmRuk=" crossorigin="anonymous" media="screen" />
  



 




<link rel="icon" type="image/png" href="/images/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/images/favicon-16x16.png" sizes="16x16">

<link rel="apple-touch-icon" href="/images/apple-touch-icon.png">
<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/images/safari-pinned-tab.svg" color="#5bbad5">




<meta name="generator" content="Hugo 0.110.0">





  </head>






<body class="preload-transitions colorscheme-dark">
  
<div class="float-container">
    <a id="dark-mode-toggle" class="colorscheme-toggle">
        <i class="fa fa-adjust fa-fw" aria-hidden="true"></i>
    </a>
</div>


  <main class="wrapper">
    <nav class="navigation">
  <section class="container">
    <a class="navigation-title" href="/">
      Zhengbledor
    </a>
    
      <input type="checkbox" id="menu-toggle" />
      <label class="menu-button float-right" for="menu-toggle">
        <i class="fa fa-bars fa-fw" aria-hidden="true"></i>
      </label>
      <ul class="navigation-list">
        
          
            <li class="navigation-item">
              <a class="navigation-link" href="/about/">About</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link" href="/posts/">Blog</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link" href="/contact/">Contact me</a>
            </li>
          
        
        
      </ul>
    
  </section>
</nav>


    <div class="content">
      
  <section class="container post">
    <article>
      <header>
        <div class="post-title">
          <h1 class="title">
            <a class="title-link" href="https://zhengbledor.github.io/posts/%E5%88%9B%E5%BB%BA%E5%9E%8B-%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/">
              创建型-单例模式
            </a>
          </h1>
        </div>
        <div class="post-meta">
          <div class="date">
            <span class="posted-on">
              <i class="fa fa-calendar" aria-hidden="true"></i>
              <time datetime="2023-03-01T00:00:00Z">
                March 1, 2023
              </time>
            </span>
            <span class="reading-time">
              <i class="fa fa-clock-o" aria-hidden="true"></i>
              2-minute read
            </span>
          </div>
          
          
          
        </div>
      </header>

      <div class="post-content">
        
        <h1 id="创建型-单例模式">
  创建型-单例模式
  <a class="heading-link" href="#%e5%88%9b%e5%bb%ba%e5%9e%8b-%e5%8d%95%e4%be%8b%e6%a8%a1%e5%bc%8f">
    <i class="fa fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h1>
<h2 id="7种单例模式的创建">
  7种单例模式的创建
  <a class="heading-link" href="#7%e7%a7%8d%e5%8d%95%e4%be%8b%e6%a8%a1%e5%bc%8f%e7%9a%84%e5%88%9b%e5%bb%ba">
    <i class="fa fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<p>单例模式的实现方式比较多，主要在实现上是否支持懒汉模式、是否线程安全中运用各种技巧。
当然也有一些场景不需要考虑懒加载的情况，会直接使用<code>static</code>静态累或属性和方法的方式进行处理，供外部调用。</p>
<h3 id="0-静态类使用">
  0. 静态类使用
  <a class="heading-link" href="#0-%e9%9d%99%e6%80%81%e7%b1%bb%e4%bd%bf%e7%94%a8">
    <i class="fa fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<div class="highlight"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#c678dd">public</span> <span style="color:#c678dd">class</span> <span style="color:#76a9f9">Singleton_00</span><span style="color:#c7bf54">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#c678dd">public</span> <span style="color:#c678dd">static</span> <span style="color:#c1abea">Map</span><span style="color:#c7bf54">&lt;</span><span style="color:#c1abea">String</span><span style="color:#c7bf54">,</span> <span style="color:#c1abea">String</span><span style="color:#c7bf54">&gt;</span> <span style="color:#c1abea">cache</span> <span style="color:#c7bf54">=</span> <span style="color:#c678dd">new</span> <span style="color:#c1abea">ConcurrentHashMap</span><span style="color:#c7bf54">&lt;</span><span style="color:#c1abea">String</span><span style="color:#c7bf54">,</span> <span style="color:#c1abea">String</span><span style="color:#c7bf54">&gt;();</span>
</span></span><span style="display:flex;"><span><span style="color:#c7bf54">}</span>
</span></span></code></pre></div><ul>
<li>这样的静态类的方式可以在第一次运行的时候直接初始化Map类，不需要到延迟加载在使用。</li>
</ul>
<h3 id="1-懒汉模式线程不安全">
  1. 懒汉模式（线程不安全）
  <a class="heading-link" href="#1-%e6%87%92%e6%b1%89%e6%a8%a1%e5%bc%8f%e7%ba%bf%e7%a8%8b%e4%b8%8d%e5%ae%89%e5%85%a8">
    <i class="fa fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<div class="highlight"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#c678dd">public</span> <span style="color:#c678dd">class</span> <span style="color:#76a9f9">Singleton_01</span> <span style="color:#c7bf54">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#c678dd">private</span> <span style="color:#c678dd">static</span> <span style="color:#c1abea">Singleton_01</span> <span style="color:#c1abea">instance</span><span style="color:#c7bf54">;</span>
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>    <span style="color:#c678dd">private</span> <span style="color:#00b1f7">Singleton_01</span><span style="color:#c7bf54">()</span> <span style="color:#c7bf54">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#c7bf54">}</span>
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>    <span style="color:#c678dd">public</span> <span style="color:#c678dd">static</span> <span style="color:#c1abea">Singleton_01</span> <span style="color:#00b1f7">getInstance</span><span style="color:#c7bf54">(){</span>
</span></span><span style="display:flex;"><span>        <span style="color:#c678dd">if</span> <span style="color:#c7bf54">(</span><span style="color:#b756ff;font-weight:bold">null</span> <span style="color:#c7bf54">!=</span> <span style="color:#c1abea">instance</span><span style="color:#c7bf54">)</span> <span style="color:#c678dd">return</span> <span style="color:#c1abea">instance</span><span style="color:#c7bf54">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#c1abea">instance</span> <span style="color:#c7bf54">=</span> <span style="color:#c678dd">new</span> <span style="color:#c1abea">Singleton_01</span><span style="color:#c7bf54">();</span>
</span></span><span style="display:flex;"><span>        <span style="color:#c678dd">return</span> <span style="color:#c1abea">instance</span><span style="color:#c7bf54">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#c7bf54">}</span>
</span></span><span style="display:flex;"><span><span style="color:#c7bf54">}</span>
</span></span></code></pre></div><ul>
<li>有一个特点就是外部不允许直接创建，只能通过<code>Singleton_01.getInstance()</code>来初始化创建该单例。</li>
<li>这种方式的范例确实满足了懒加载，但是如果多个访问者同时进入<code>getInstance()</code>中可能会出现同时存在多个实例的问题。</li>
</ul>
<h3 id="2-懒汉模式线程安全">
  2. 懒汉模式（线程安全）
  <a class="heading-link" href="#2-%e6%87%92%e6%b1%89%e6%a8%a1%e5%bc%8f%e7%ba%bf%e7%a8%8b%e5%ae%89%e5%85%a8">
    <i class="fa fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<div class="highlight"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#c678dd">public</span> <span style="color:#c678dd">class</span> <span style="color:#76a9f9">Singleton_02</span> <span style="color:#c7bf54">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#c678dd">private</span> <span style="color:#c678dd">static</span> <span style="color:#c1abea">Singleton_02</span> <span style="color:#c1abea">instance</span><span style="color:#c7bf54">;</span>
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>    <span style="color:#c678dd">private</span> <span style="color:#00b1f7">Singleton_02</span><span style="color:#c7bf54">()</span> <span style="color:#c7bf54">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#c7bf54">}</span>
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>    <span style="color:#c678dd">public</span> <span style="color:#c678dd">static</span> <span style="color:#c678dd">synchronized</span> <span style="color:#c1abea">Singleton_02</span> <span style="color:#00b1f7">getInstance</span><span style="color:#c7bf54">(){</span>
</span></span><span style="display:flex;"><span>        <span style="color:#c678dd">if</span> <span style="color:#c7bf54">(</span><span style="color:#b756ff;font-weight:bold">null</span> <span style="color:#c7bf54">!=</span> <span style="color:#c1abea">instance</span><span style="color:#c7bf54">)</span> <span style="color:#c678dd">return</span> <span style="color:#c1abea">instance</span><span style="color:#c7bf54">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#c1abea">instance</span> <span style="color:#c7bf54">=</span> <span style="color:#c678dd">new</span> <span style="color:#c1abea">Singleton_02</span><span style="color:#c7bf54">();</span>
</span></span><span style="display:flex;"><span>        <span style="color:#c678dd">return</span> <span style="color:#c1abea">instance</span><span style="color:#c7bf54">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#c7bf54">}</span>
</span></span><span style="display:flex;"><span><span style="color:#c7bf54">}</span>
</span></span></code></pre></div><ul>
<li>这种模式虽然是安全的，但是由于加锁的原因，所有的访问者都会因为需要锁的占用导致资源浪费。</li>
</ul>
<h3 id="3-饿汉模式线程安全">
  3. 饿汉模式（线程安全）
  <a class="heading-link" href="#3-%e9%a5%bf%e6%b1%89%e6%a8%a1%e5%bc%8f%e7%ba%bf%e7%a8%8b%e5%ae%89%e5%85%a8">
    <i class="fa fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<div class="highlight"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#c678dd">public</span> <span style="color:#c678dd">class</span> <span style="color:#76a9f9">Singleton_03</span> <span style="color:#c7bf54">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#c678dd">private</span> <span style="color:#c678dd">static</span> <span style="color:#c1abea">Singleton_03</span> <span style="color:#c1abea">instance</span> <span style="color:#c7bf54">=</span> <span style="color:#c678dd">new</span> <span style="color:#c1abea">Singleton_03</span><span style="color:#c7bf54">();</span>
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>    <span style="color:#c678dd">private</span> <span style="color:#00b1f7">Singleton_03</span><span style="color:#c7bf54">()</span> <span style="color:#c7bf54">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#c7bf54">}</span>
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>    <span style="color:#c678dd">public</span> <span style="color:#c678dd">static</span> <span style="color:#c1abea">Singleton_03</span> <span style="color:#00b1f7">getInstance</span><span style="color:#c7bf54">()</span> <span style="color:#c7bf54">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#c678dd">return</span> <span style="color:#c1abea">instance</span><span style="color:#c7bf54">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#c7bf54">}</span> 
</span></span><span style="display:flex;"><span><span style="color:#c7bf54">}</span>
</span></span></code></pre></div><ul>
<li>不是懒加载，无论是否用到了这个单例都会在程序启动的时候就创建。</li>
</ul>
<h3 id="4-使用内部类线程安全">
  4. 使用内部类（线程安全）
  <a class="heading-link" href="#4-%e4%bd%bf%e7%94%a8%e5%86%85%e9%83%a8%e7%b1%bb%e7%ba%bf%e7%a8%8b%e5%ae%89%e5%85%a8">
    <i class="fa fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<div class="highlight"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#c678dd">public</span> <span style="color:#c678dd">class</span> <span style="color:#76a9f9">Singleton_04</span> <span style="color:#c7bf54">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#c678dd">private</span> <span style="color:#c678dd">static</span> <span style="color:#c678dd">class</span> <span style="color:#76a9f9">SingletonHolder</span> <span style="color:#c7bf54">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#c678dd">private</span> <span style="color:#c678dd">static</span> <span style="color:#c1abea">Singleton_04</span> <span style="color:#c1abea">instance</span> <span style="color:#c7bf54">=</span> <span style="color:#c678dd">new</span> <span style="color:#c1abea">Singleton_04</span><span style="color:#c7bf54">();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#c7bf54">}</span>
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>    <span style="color:#c678dd">private</span> <span style="color:#00b1f7">Singleton_04</span><span style="color:#c7bf54">()</span> <span style="color:#c7bf54">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#c7bf54">}</span>
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>    <span style="color:#c678dd">public</span> <span style="color:#c678dd">static</span> <span style="color:#c1abea">Singleton_04</span> <span style="color:#00b1f7">getInstance</span><span style="color:#c7bf54">()</span> <span style="color:#c7bf54">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#c678dd">return</span> <span style="color:#c1abea">SingletonHolder</span><span style="color:#c7bf54">.</span><span style="color:#b3d23c">instance</span><span style="color:#c7bf54">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#c7bf54">}</span> 
</span></span><span style="display:flex;"><span><span style="color:#c7bf54">}</span>
</span></span></code></pre></div><ul>
<li>使用类的静态内部类实现的单例，既保证了线程安全又保证了懒加载，同时不会因为加锁的方式耗费性能。</li>
<li>这主要是因为JVM虚拟机可以保证多线程并发访问的正确，也就是一个类的构造方法在多线程环境下可以被正确的加载。</li>
<li>非常推荐</li>
</ul>
<h3 id="5-双重锁校验线程安全">
  5. 双重锁校验（线程安全）
  <a class="heading-link" href="#5-%e5%8f%8c%e9%87%8d%e9%94%81%e6%a0%a1%e9%aa%8c%e7%ba%bf%e7%a8%8b%e5%ae%89%e5%85%a8">
    <i class="fa fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<div class="highlight"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#c678dd">public</span> <span style="color:#c678dd">class</span> <span style="color:#76a9f9">Singleton_05</span> <span style="color:#c7bf54">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#c678dd">private</span> <span style="color:#c678dd">static</span> <span style="color:#c1abea">Singleton_05</span> <span style="color:#c1abea">instance</span><span style="color:#c7bf54">;</span>
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>    <span style="color:#c678dd">private</span> <span style="color:#00b1f7">Singleton_05</span><span style="color:#c7bf54">()</span> <span style="color:#c7bf54">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#c7bf54">}</span>
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>    <span style="color:#c678dd">public</span> <span style="color:#c678dd">static</span> <span style="color:#c1abea">Singleton_05</span> <span style="color:#00b1f7">getInstance</span><span style="color:#c7bf54">(){</span>
</span></span><span style="display:flex;"><span>       <span style="color:#c678dd">if</span><span style="color:#c7bf54">(</span><span style="color:#b756ff;font-weight:bold">null</span> <span style="color:#c7bf54">!=</span> <span style="color:#c1abea">instance</span><span style="color:#c7bf54">)</span> <span style="color:#c678dd">return</span> <span style="color:#c1abea">instance</span><span style="color:#c7bf54">;</span>
</span></span><span style="display:flex;"><span>       <span style="color:#c678dd">synchronized</span> <span style="color:#c7bf54">(</span><span style="color:#c1abea">Singleton_05</span><span style="color:#c7bf54">.</span><span style="color:#b3d23c">class</span><span style="color:#c7bf54">){</span>
</span></span><span style="display:flex;"><span>           <span style="color:#c678dd">if</span> <span style="color:#c7bf54">(</span><span style="color:#b756ff;font-weight:bold">null</span> <span style="color:#c7bf54">==</span> <span style="color:#c1abea">instance</span><span style="color:#c7bf54">){</span>
</span></span><span style="display:flex;"><span>               <span style="color:#c1abea">instance</span> <span style="color:#c7bf54">=</span> <span style="color:#c678dd">new</span> <span style="color:#c1abea">Singleton_05</span><span style="color:#c7bf54">();</span>
</span></span><span style="display:flex;"><span>           <span style="color:#c7bf54">}</span> 
</span></span><span style="display:flex;"><span>       <span style="color:#c7bf54">}</span>
</span></span><span style="display:flex;"><span>       <span style="color:#c678dd">return</span> <span style="color:#c1abea">instance</span><span style="color:#c7bf54">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#c7bf54">}</span>
</span></span><span style="display:flex;"><span><span style="color:#c7bf54">}</span>
</span></span></code></pre></div><ul>
<li>双重锁是方法级锁的优化，减少了部分获取实例的消耗</li>
</ul>
<h3 id="6-cas-atomicreference线程安全">
  6. CAS [AtomicReference]（线程安全）
  <a class="heading-link" href="#6-cas-atomicreference%e7%ba%bf%e7%a8%8b%e5%ae%89%e5%85%a8">
    <i class="fa fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<div class="highlight"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#c678dd">public</span> <span style="color:#c678dd">class</span> <span style="color:#76a9f9">Singleton_06</span> <span style="color:#c7bf54">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#c678dd">private</span> <span style="color:#c678dd">static</span> <span style="color:#c678dd">final</span> <span style="color:#c1abea">AtomicReference</span><span style="color:#c7bf54">&lt;</span><span style="color:#c1abea">Singleton_06</span><span style="color:#c7bf54">&gt;</span> <span style="color:#c1abea">INSTANCE</span> <span style="color:#c7bf54">=</span> <span style="color:#c678dd">new</span> <span style="color:#c1abea">AtomicReference</span><span style="color:#c7bf54">&lt;</span><span style="color:#c1abea">Singleton_06</span><span style="color:#c7bf54">&gt;();</span>
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>    <span style="color:#c678dd">private</span> <span style="color:#c678dd">static</span> <span style="color:#c1abea">Singleton_06</span> <span style="color:#c1abea">instance</span><span style="color:#c7bf54">;</span>
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>    <span style="color:#c678dd">private</span> <span style="color:#00b1f7">Singleton_06</span><span style="color:#c7bf54">()</span> <span style="color:#c7bf54">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#c7bf54">}</span>
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>    <span style="color:#c678dd">public</span> <span style="color:#c678dd">static</span> <span style="color:#c678dd">final</span> <span style="color:#c1abea">Singleton_06</span> <span style="color:#00b1f7">getInstance</span><span style="color:#c7bf54">()</span> <span style="color:#c7bf54">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#c678dd">for</span> <span style="color:#c7bf54">(;</span> <span style="color:#c7bf54">;</span> <span style="color:#c7bf54">)</span> <span style="color:#c7bf54">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#c1abea">Singleton_06</span> <span style="color:#c1abea">instance</span> <span style="color:#c7bf54">=</span> <span style="color:#c1abea">INSTANCE</span><span style="color:#c7bf54">.</span><span style="color:#b3d23c">get</span><span style="color:#c7bf54">();</span>
</span></span><span style="display:flex;"><span>            <span style="color:#c678dd">if</span> <span style="color:#c7bf54">(</span><span style="color:#b756ff;font-weight:bold">null</span> <span style="color:#c7bf54">!=</span> <span style="color:#c1abea">instance</span><span style="color:#c7bf54">)</span> <span style="color:#c678dd">return</span> <span style="color:#c1abea">instance</span><span style="color:#c7bf54">;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#c1abea">INSTANCE</span><span style="color:#c7bf54">.</span><span style="color:#b3d23c">compareAndSet</span><span style="color:#c7bf54">(</span><span style="color:#b756ff;font-weight:bold">null</span><span style="color:#c7bf54">,</span> <span style="color:#c678dd">new</span> <span style="color:#c1abea">Singleton_06</span><span style="color:#c7bf54">());</span>
</span></span><span style="display:flex;"><span>            <span style="color:#c678dd">return</span> <span style="color:#c1abea">INSTANCE</span><span style="color:#c7bf54">.</span><span style="color:#b3d23c">get</span><span style="color:#c7bf54">();</span>
</span></span><span style="display:flex;"><span>        <span style="color:#c7bf54">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#c7bf54">}</span>
</span></span><span style="display:flex;"><span>  <span style="color:#c678dd">public</span> <span style="color:#c678dd">static</span> <span style="color:#ef8383">void</span> <span style="color:#00b1f7">main</span><span style="color:#c7bf54">(</span><span style="color:#c1abea">String</span><span style="color:#c7bf54">[]</span> <span style="color:#c1abea">args</span><span style="color:#c7bf54">)</span> <span style="color:#c7bf54">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#c1abea">System</span><span style="color:#c7bf54">.</span><span style="color:#b3d23c">out</span><span style="color:#c7bf54">.</span><span style="color:#b3d23c">println</span><span style="color:#c7bf54">(</span><span style="color:#c1abea">Singleton_06</span><span style="color:#c7bf54">.</span><span style="color:#b3d23c">getInstance</span><span style="color:#c7bf54">());</span> <span style="color:#8a93a5;font-style:italic">// org.itstack.demo.design.Singleton_06@2b193f2d
</span></span></span><span style="display:flex;"><span><span style="color:#8a93a5;font-style:italic"></span>    <span style="color:#c1abea">System</span><span style="color:#c7bf54">.</span><span style="color:#b3d23c">out</span><span style="color:#c7bf54">.</span><span style="color:#b3d23c">println</span><span style="color:#c7bf54">(</span><span style="color:#c1abea">Singleton_06</span><span style="color:#c7bf54">.</span><span style="color:#b3d23c">getInstance</span><span style="color:#c7bf54">());</span> <span style="color:#8a93a5;font-style:italic">// org.itstack.demo.design.Singleton_06@2b193f2d
</span></span></span><span style="display:flex;"><span><span style="color:#8a93a5;font-style:italic"></span>  <span style="color:#c7bf54">}</span>
</span></span><span style="display:flex;"><span><span style="color:#c7bf54">}</span>
</span></span></code></pre></div><ul>
<li>java并发库提供了很多原子类来支持并发访问的数据安全性</li>
<li>AtomicReference可以封装引用一个V实例，支持并发访问如上的单例方式就是使用了这样的一个特点。</li>
<li>使用CAS的好处就是不需要使用传统的加锁方式保证线程安全，而是依赖于CAS的忙等算法，依赖于底层硬件的实现，来保证线程安全。相对于其他锁的实现没有线程的切换和阻塞也就没有了额外的开销，并且可以支持较大的并发性。</li>
<li>当然CAS也有一个缺点就是忙等，如果一直没有获取到将会处于死循环中。</li>
</ul>
<h3 id="7-枚举单例">
  7. 枚举单例
  <a class="heading-link" href="#7-%e6%9e%9a%e4%b8%be%e5%8d%95%e4%be%8b">
    <i class="fa fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<div class="highlight"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#c678dd">public</span> <span style="color:#c678dd">enum</span> <span style="color:#c1abea">Singleton_07</span> <span style="color:#c7bf54">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#c1abea">INSTANCE</span><span style="color:#c7bf54">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#c678dd">public</span> <span style="color:#ef8383">void</span> <span style="color:#00b1f7">test</span><span style="color:#c7bf54">(){</span>
</span></span><span style="display:flex;"><span>        <span style="color:#c1abea">System</span><span style="color:#c7bf54">.</span><span style="color:#b3d23c">out</span><span style="color:#c7bf54">.</span><span style="color:#b3d23c">println</span><span style="color:#c7bf54">(</span><span style="color:#98c379">&#34;hi~&#34;</span><span style="color:#c7bf54">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#c7bf54">}</span>
</span></span><span style="display:flex;"><span><span style="color:#c7bf54">}</span>
</span></span></code></pre></div>
      </div>


      <footer>
        


        
        
        
        
      </footer>
    </article>

    
  </section>

    </div>

    <footer class="footer">
  <section class="container">
    ©
    
    2023
     Zhengbledor 
    ·
    
    Powered by <a href="https://gohugo.io/">Hugo</a> & <a href="https://github.com/luizdepra/hugo-coder/">Coder</a>.
    
  </section>
</footer>

  </main>

  

  
  
  <script src="/js/coder.min.6ae284be93d2d19dad1f02b0039508d9aab3180a12a06dcc71b0b0ef7825a317.js" integrity="sha256-auKEvpPS0Z2tHwKwA5UI2aqzGAoSoG3McbCw73gloxc="></script>
  

  

  


  

  

  

  

  

  

  

  

  

  

  
</body>

</html>
